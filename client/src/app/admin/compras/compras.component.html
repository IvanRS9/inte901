<div class="container mx-auto w-full p-4">
  <div class="justify-end mb-4">
    <hlm-sheet side="right">
      <button id="carrito" variant="success" brnSheetTrigger hlmBtn>
        Lista de compras
      </button>
      <hlm-sheet-content *brnSheetContent="let ctx">
        <hlm-sheet-header>
          <h3 hlmSheetTitle>Lista de compras</h3>
        </hlm-sheet-header>
        <div>

        </div>
        <div class="flex justify-between">
          <button variant="success" hlmBtn>
            Solicitar
          </button>
        </div>
      </hlm-sheet-content>
    </hlm-sheet>

    <hlm-dialog class="w-[500px]">
      <button id="edit-profile" variant="success" brnDialogTrigger hlmBtn>Realizar compra</button>
      <hlm-dialog-content class="min-w-[500px] w-full bg-success" *brnDialogContent="let ctx">
        <hlm-dialog-header>
          <h3 class="text-white" hlmDialogTitle>Compra de materia prima</h3>
        </hlm-dialog-header>
        <form (ngSubmit)="addToCart(comprasFormAdd)" #comprasFormAdd="ngForm">
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="flex-1" for="insumos">Proveedor*</label>
            </div>
            <div>
              <brn-popover [state]="state()" (stateChanged)="stateChanged($event)" sideOffset="5" closeDelay="100">
                <button [disabled]="isProveedorDisabled()" class="flex-1 justify-between" id="selectedProveedor" variant="outline" brnPopoverTrigger
                  hlmBtn>
                  {{ currentFramework()?.label ?? 'Seleccionar' }}
                  <hlm-icon size="sm" name="lucideChevronsUpDown" />
                </button>
                <brn-cmd *brnPopoverContent="let ctx" hlmPopoverContent hlm class="p-0 w-[200px] bg-primary">
                  <hlm-cmd-input-wrapper>
                    <hlm-icon name="lucideSearch" />
                    <input placeholder="Buscar Proveedor" brnCmdInput hlm />
                  </hlm-cmd-input-wrapper>
                  <div *brnCmdEmpty hlmCmdEmpty>No se encontr&oacute;</div>
                  <brn-cmd-list hlm>
                    <brn-cmd-group hlm>
                      <button *ngFor="let framework of frameworks" brnCmdItem [value]="framework.value"
                        (selected)="commandSelected(framework)" hlm>
                        <hlm-icon [class.opacity-0]="currentFramework()?.value !== framework.value" name="lucideCheck"
                          hlmCmdIcon />
                        {{ framework.label }}
                      </button>
                    </brn-cmd-group>
                  </brn-cmd-list>
                </brn-cmd>
              </brn-popover>
            </div>
          </div>
          <br>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="flex-1" for="cantidad">Cantidad*</label>
            </div>
            <div>
              <input required type="number" hlmInput class="flex-1" name="cantidad" id="cantidad" [(ngModel)]="cantidad">
            </div>
          </div>
          <br>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="flex-1" for="precio">Precio Unitario*</label>
            </div>
            <div>
              <input required type="number" hlmInput class="flex-1" name="preciounitario" id="preciounitario" [(ngModel)]="precioUnitario">
            </div>
          </div>
          <br>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="flex-1" for="presentacion">Presentaci&oacute;n*</label>
            </div>
            <div>
              <brn-popover [state]="statePresentation()" (stateChanged)="statePresentationChanged($event)"
                sideOffset="5" closeDelay="100">
                <button class="flex-1] justify-between" id="presentacion" variant="outline" brnPopoverTrigger
                  hlmBtn>
                  {{ currentPresentation() ? currentPresentation()?.label ||'' : 'Seleccionar' }}
                  <hlm-icon size="sm" name="lucideChevronsUpDown" />
                </button>
                <brn-cmd *brnPopoverContent="let ctx" hlmPopoverContent hlm class="p-0 w-[200px] bg-primary">
                  <hlm-cmd-input-wrapper>
                    <hlm-icon name="lucideSearch" />
                    <input placeholder="Buscar presentaciÃ³n" brnCmdInput hlm />
                  </hlm-cmd-input-wrapper>
                  <div *brnCmdEmpty hlmCmdEmpty>No hay resultados</div>
                  <brn-cmd-list hlm>
                    <brn-cmd-group hlm>
                      <button *ngFor="let framework of presentations" brnCmdItem [value]="framework.value"
                        (selected)="commandPresentationSelected(framework)" hlm>
                        <hlm-icon [class.opacity-0]="currentPresentation()?.value !== framework.value"
                          name="lucideCheck" hlmCmdIcon />
                        {{ framework.label }}
                      </button>
                    </brn-cmd-group>
                  </brn-cmd-list>
                </brn-cmd>
              </brn-popover>
            </div>
          </div>
          <br>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="flex-1" for="producto">Insumos</label>
            </div>
            <div>
              <brn-popover [state]="stateMpp()" (stateChanged)="stateMppChanged($event)" sideOffset="5" closeDelay="100">
                <button class="w-[200px] justify-between" id="selectedInsumo" variant="outline" brnPopoverTrigger hlmBtn>
                  {{ currentMpp() ? currentMpp()?.label || '' : 'Seleccionar' }}
                  <hlm-icon size="sm" name="lucideChevronsUpDown" />
                </button>

                <brn-cmd *brnPopoverContent="let ctx" hlmPopoverContent hlm class="p-0 w-[200px]">
                  <hlm-cmd-input-wrapper>
                    <hlm-icon name="lucideSearch" />
                    <input placeholder="Search MPP..." brnCmdInput hlm />
                  </hlm-cmd-input-wrapper>

                  <div *brnCmdEmpty hlmCmdEmpty>No results found.</div>

                  <brn-cmd-list hlm>
                    <brn-cmd-group hlm>
                      <button *ngFor="let mpp of mppF" brnCmdItem [value]="mpp.material || ''"
                              (selected)="commandMppSelected(mpp)" hlm>
                        <hlm-icon [class.opacity-0]="currentMpp()?.value !== mpp.material" name="lucideCheck" hlmCmdIcon />
                        {{ mpp.material }}
                      </button>
                    </brn-cmd-group>
                  </brn-cmd-list>
                </brn-cmd>
              </brn-popover>
            </div>
          </div>
          <hlm-dialog-footer>
            <button hlmBtn type="submit" variant="primary">Agregar a lista</button>
          </hlm-dialog-footer>
        </form>
        <br>
      </hlm-dialog-content>
    </hlm-dialog>
  </div>
</div>
